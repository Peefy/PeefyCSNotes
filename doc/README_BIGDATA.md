
## 大数据和分布式

* **Scala**
* **Spark**
* **Hadoop**

### 大数据和分布式问答

**1. MapReduce写好友推荐**

userCF和ItemCF

**2. 在一堆单词里面找出现次数最多的k个**

map-每个map的cleanup()输出topk 

reduce-汇总map topk

**3. hadoop原理**

分布式文件系统HDFS

一种编程模型，用于大规模数据集（大于1TB）的并行运算MapReduce

**4. shuffle如何排序**

MapReduce提供Partitioner接口，它的作用就是根据key或value及reduce的数量来决定当前的

这对输出数据最终应该交由哪个reduce task处理，默认对key hash后再以reduce task数量取模。 

Shuffle在map端的过程：1、输入数据经过mapper输出key-value对 2经过分区操作、内存的排序、每个分组合并操作。 

Shuffle在reduce端的过程：1Copy map结果过程 2 Merge阶段 3生成Reducer的输入文件。

**5. map如何切割数据**

splitSize不小于minSize以及不大于blockSiz，如果map任务的文件分割大小splitSize超过

blockSize，那么每个map任务可能需要跨多个datanode获取文件，会导致额外增加网络开销，

因为通常一个map会被分配在该文件所在的datanode上运行，这样本地读取文件，则不需要网络开销。mapper函数对block的每行数据进行处理

**6. 如何处理数据倾斜**

1. 增加reduce 的jvm内存 单个值有大量记录的不适用 
2. 增加reduce 个数 单个值有大量记录的不适用 唯一值较多的适用(某些reduce分配了多个较多记录) 
3. 明白数据倾斜的分布自己实现分区 
4. 单独处理倾斜数据-实现新的key使不倾斜 特定情况特殊分析

**7. join的mr代码**

reduce side join-跨机器传输数据量大 

map同时读取两个文件File1和File2 标签来自文件1还是文件2 

reduce函数获取key相同的来自File1和File2文件的value list进行join（笛卡尔乘积) 

map side join- 小表连大表 

小表复制到每个map task 

map扫描大表 在hash table中查找是否有相同的key的记录连接输出 

SemiJoin-半连接优化reduce side join 

File1的join的key抽出放入内存中File3(较小) 

map期间File2在File3的进行reduce不在的跳过(减少了map端的输出)

**8. **

**9. **

**10. **

**11. **

**12. **

**13. **

**14. **

**15. **

**16. **

**17. **

**18. **

**19. **

**20. **

**21. **

**22. **

**23. **

**24. **

**25. **

**26. **

**27. **

**28. **

**29. **

**30. **

**31. **

**32. **

**33. **

**34. **

**35. **

**36. **

**37. **

**38. **

**39. **

**40. **

**41. **

**42. **

**43. **

**44. **

**45. **

**46. **

**47. **

**48. **

**49. **

**50. **

**51. **

**52. **

**53. **

**54. **

**55. **

**56. **

**57. **

**58. **

**59. **

**60. **

**61. **

**62. **

**63. **

**64. **

**65. **

**66. **

**67. **

**68. **

**69. **

**70. **

**71. **

**72. **

**73. **

**74. **

**75. **

**76. **

**77. **

**78. **

**79. **

**80. **

**81. **

**82. **

**83. **

**84. **

**85. **

**86. **

**87. **

**88. **

**89. **

**90. **

**91. **

**92. **

**93. **

**94. **

**95. **

**96. **

**97. **

**98. **

**99. **

**100. **

**101. **

**102. **

**103. **

**104. **

**105. **

**106. **

**107. **

**108. **

**109. **

**110. **

**111. **

**112. **

**113. **

**114. **

**115. **

**116. **

**117. **

**118. **

**119. **

**120. **

**121. **

**122. **

**123. **

**124. **

**125. **

**126. **

**127. **

**128. **

**129. **

**130. **

**131. **

**132. **

**133. **

**134. **

**135. **

**136. **

**137. **

**138. **

**139. **

**140. **

**141. **

**142. **

**143. **

**144. **

**145. **

**146. **

**147. **

**148. **

**149. **

**150. **

**151. **

**152. **

**153. **

**154. **

**155. **

**156. **

**157. **

**158. **

**159. **

**160. **

**161. **

**162. **

**163. **

**164. **

**165. **

**166. **

**167. **

**168. **

**169. **

**170. **

**171. **

**172. **

**173. **

**174. **

**175. **

**176. **

**177. **

**178. **

**179. **

**180. **

**181. **

**182. **

**183. **

**184. **

**185. **

**186. **

**187. **

**188. **

**189. **

**190. **

**191. **

**192. **

**193. **

**194. **

**195. **

**196. **

**197. **

**198. **

**199. **


