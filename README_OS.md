
## 操作系统

*线程和进程的区别*

**进程**: 是并发执行的程序在执行过程中分配和管理资源的基本单位，是一个动态概念，竞争计算机系统资源的基本单位

**线程**: 是进程的一个执行单元，是进程内科调度实体。比进程更小的独立运行的基本单位。线程也被称为轻量级进程

*一个程序至少一个进程，一个进程至少一个线程*

每个进程都有自己的地址空间，即进程空间，在网络或多用户换机下，一个服务器通常需要接收大量不确定数量用户的并发请求，为每一个请求都创建一个进程显然行不通（系统开销大响应用户请求效率低），因此操作系统中线程概念被引进

* 线程的执行过程是线性的，尽管中间会发生中断或者暂停，但是进程所拥有的资源只为改变线状执行过程服务，一旦发生线程切换，这些资源需要被保护起来

* 进程分为单线程进程和多线程进程，单线程进程宏观看起来也是线性执行过程，微观上只有单一的执行过程。多线程进程是宏观是线性的，微观上执行过个操作

线程的改变只代表CPU的执行过程的改变，而没有发生进程所拥有的资源的变化

*进程线程的区别*

* 地址空间：同一进程的线程共享本进程的地址空间，而进程之间则是独立的地址空间
* 资源拥有：同一进程的线程共享本进程的资源如内存、I/O、CPU等，但是进程之间的资源是独立的

一个进程崩溃后，在保护模式下不会对其他进程产生影响，但是一个线程崩溃整个进程都死掉。所以多进程要比多线程健壮

进程切换时，消耗的资源大，效率高。所以涉及到频繁的切换时，使用线程要好于进程。同样如果要求同时进行并且又要共享某些变量的并发操作，只能用线程不能用进程

* 执行过程：每个独立的进程有一个程序运行的入口、顺序执行序列和程序入口。但是线程不能独立执行，必须依存在应用程序中,由应用程序提供过个线程执行控制
* 线程是处理器调度的基本单位，但是进程不是
* 两者均可并发执行

优缺点：

* 线程执行开销小，但是不利于资源的管理和保护。线程适合在SMP机器(双CPU系统)上运行
* 进程执行开销大，但是能够很好的进行资源管理和保护。进程可以跨机器前移.

*对资源的管理和保护要求高，不限制开销和效率时，使用多进程；要求效率高，频繁切换时，资源的保护管理要求不是很高时，使用多线程*

*Buffer和Cathe的区别*

* **Buffer**-缓冲区，用于存储速度不同步的设备或优先级不同的设备之间传输数据；通过buffer可以减少进程间通信需要等待的时间，当存储速度快的设备与存储速度慢的设备进行通信时，存储慢的数据先把数据存放到buffer，达到一定程度存储快的设备再读取buffer的数据，在此期间存储快的设备CPU可以干其他的事情
* **Cache**-Cache：缓存区，是高速缓存，是位于CPU和主内存之间的容量较小但速度很快的存储器，因为CPU的速度远远高于主内存的速度，CPU从内存中读取数据需等待很长的时间，而  Cache保存着CPU刚用过的数据或循环使用的部分数据，这时从Cache中读取数据会更快，减少了CPU等待的时间，提高了系统的性能

**操作系统内存管理**

## LRU - Least Recently Used 最近最少使用

内存管理的一种页面置换算法，对于在内存中但又不用的数据块（内存块）叫做LRU，操作系统会根据哪些数据属于LRU而将其移出内存而腾出空间来加载另外的数据。

关于`操作系统的内存管理`，如何节省利用容量不大的内存为最多的`进程`提供资源，一直是研究的重要方向。而内存的虚拟存储管理，是现在最通用，最成功的方式—— 在内存有限的情况下，**扩展一部分外存作为虚拟内存**，真正的内存只存储当前运行时所用得到信息。

<img src="https://github.com/Peefy/PeefyCSNotes/tree/master/src/LRU.jpg" />

> 可以基于 哈希表HashMap 和 双向链表实现 LRU 

可以使用 HashMap 存储 key，这样可以做到 save 和 get key的时间都是 O(1)，而 HashMap 的 Value 指向双向链表实现的 LRU 的 Node 节点，如图所示。LRU 存储是基于双向链表实现的，其中 head 代表双向链表的表头，tail 代表尾部。首先预先设置 LRU 的容量，如果存储满了，可以通过 O(1) 的时间淘汰掉双向链表的尾部，每次新增和访问数据，都可以通过 O(1)的效率把新的节点增加到对头，或者把已经存在的节点移动到队头。

## Linux

### Linux简介

Linux是一套免费使用核自由传播的类Unix操作系统，是一个基于POSIX和UNIX的多用户、多任务、支持多线程和多CPU的操作系统

Linux能运行主要的UNIX工具软件、应用程序和网络协议。支持32位和64位硬件。Linux继承了Unix以网络为核心的设计思想，是一个性能稳定的多用户网络操作系统

**Linux的发行版本**

Linux的发行版本说简单点就是将Linux内核与应用软件做一个打包

知名的发行版：Ubuntu、RedHat、CentOS、Debian、Fedora、SuSE、OpenSUSE、Arch Linux、SolusOS等

**Linux应用领域**

各种场合都适用各种Linux发行版，从嵌入式设备到超级计算机，并且在服务器领域确定了地位，通常服务器适用LAMP(Linux+Apache+MySQL+PHP)或(Linux+Nginx+MySQL+PHP)组合

### Linux安装

[64位Linux系统CentOS](http://www.runoob.com/linux/linux-install.html)

### Linux系统启动过程

* 内核引导：打开电源，BIOS开机自检，按照设置的启动设备（硬盘）启动，操作系统接管硬件，首先读入/boot目录下的内核文件
* 运行init：init进程是系统所有进程的起点，是所有进程的老祖宗，没有这个进程，系统中任何进程都不会启动，init进程首先读取配置文件/etc/inittab。

许多程序需要开机启动，在windows叫做服务(service)，在linux叫做守护进程(daemon),但是不同的场合需要启动不同的程序，比如用作服务器时，需要启动Apache，用作桌面就不需要。Linux允许为不同的场合，分配不同的开机启动程序，这就叫做“运行级别”(runlevel),就是说，启动时根据“运行级别”，确定要运行哪些程序。

Linux系统由7个运行级别

* 系统初始化：在init的配置文件中有这么一行：si::sysinit"/etc/rc.d/rc.sysinit 调用了/etc/rc.d/rc.sysinit,而它是bash shell脚本
* 建立终端：rc执行完毕后，返回init。这时基本系统环境已经建立好了，各种守护进程也已经启动了。init接下来会打开6个终端，以便用户登录系统，
* 用户登录系统：命令行登录、ssh登录、图形界面登录

**图形模式与文字模式相互切换**

Linux预设提供了六个命令窗口终端机让我们登录，默认登录窗口tty1，可以按下Ctrl+Alt+F1~F6来切换，如果安装了图形界面，默认情况进入图形界面，Ctrl+Alt+F7可以从文字模式界面回到图形模式界面

**Linux关机**

在Linux领域内大多用在服务器上，很少遇到关机的操作。服务器上跑一个服务是永无止境的，除非特殊情况下

正确关机的流程：sync > shutdown > reboot > halt

关机指令为：shutdown，可以使用man shutdown来看一下帮助文档

sync: 将数据由内存同步到硬盘中

### Linux系统结构目录

在Linux或Unix操作系统中，所有的文件和目录都被组织成以一个根结点开始的倒置的树状结构。文件系统的最顶层是由根目录开始的，系统使用/来表示根目录
* . : 代表当前的目录，也可以使用./来表示
* .. : 代表上一层目录，也可以../来代表

登录系统后，在当前命令窗口下输入命令，可以看到树状目录结构
```shell
ls /
```

* /bin : bin是Binary的缩写，存放着最经常使用的命令
* /boot : 存放的是启动Linux时使用的一些核心文件，包括一些连接文件以及镜像文件
* /dev : dev是Device(设备)的缩写，该目录下存放的是Linux的外部设备，在Linux中访问设备的方式和访问文件的方式是相同的。
* /etc : 这个目录用来存放所有的系统管理所需要的配置文件和子目录
* /home : 用户的主目录，在Linux中，每个用户都有一个自己的目录，一般该目录名是以用户的账号命名的
* /lib : 存放着系统最基本的动态链接共享库，类似于Windows里的DLL文件。几乎所有的应用程序都需要用到这些共享库
* /lost+found : 这个目录一般情况下是空的，当系统非法关机后，这里就存放了一些文件
* /media : linux系统会自动识别一些设备，例如一些设备，例如U盘，光驱等等，当识别后，linux会把识别的设备挂到这个目录下
* /mnt : 系统提供该目录是为了让用户临时挂载别的文件系统的，可以将光驱挂载在/mnt/上，然后进入该目录就可以查看光驱里的内容
* /opt : 这是给主机额外安装软件所摆放的目录。比如你安装一个ORACLE数据库则就可以放到这个目录下，默认是空的
* /proc : 虚拟的目录，系统内存的映射
* /root : 该目录为系统管理员，也称作超级权限者的用户主目录
* /sbin : s就是Super User的意思，这里存放的是系统管理员使用的系统管理程序
* /selinux : 这个目录是Redhat/CentOS所特有的目录，Selinux是一个安全机制，类似于windows的防火墙，但是这套机制比较复杂，这个目录就是存放selinux相关的文件的
* /srv : 该目录存放一些服务启动之后需要提取的数据
* /sys : 这是linux2.6内核一个很大的变化，该目录下安装了2.6内核中新出现的一个文件系统sysfs文件系统集成了下面3中文件系统的信息：针对进程信息的proc文件系统、针对设备的devfs文件系统以及针对伪终端的devpts文件系统
* /tmp : 存放一些临时文件
* /usr : 这是一个非常重要的目录，用户的很多应用程序和文件都放在这个目录下，类似于windows的program files目录
* /usr/bin : 系统用户使用的应用程序
* /usr/sbin : 超级用几用户使用的比较高级的管理程序和系统守护程序
* /usr/src : 内核源代码默认的放置目录
* /var : 目录存放着不断扩充着的东西，习惯将经常修改的目录放在里面。包括各种日志文件。
* /run : 临时文件系统，存储系统启动以来的信息。当系统重启时，这个目录下的文件应该被删除或清除。如果系统上有/var/run目录,应该指向run

在Linux系统中，有几个目录是比较重要的，注意不要误删除或者随意更改内部文件。

/etc : 上边也提到了，是系统的配置文件，如果更改了该目录下的某个文件可能会导致系统不能启动

/bin,/sbin,/usr/bin,/usr/sbin : 这是系统预设的执行文件的放置目录，比如ls就是/bin/ls目录下的。值得提出的是，/bin,/usr/bin是给系统用户使用的指令(除root外的通用户),而/sbin,/usr/sbin则是给root使用的指令。

/var : 非常重要的目录，系统上跑了很多程序，那么每个程序都会有相应的日志产生，而这些日志就被记录到这个目录下，具体在/var/log目录下，另外mail的预设放置也是在这里.

### Linux忘记密码解决方法

忘记密码后，不需要重新安装系统，进入单用户模式更改一下root密码即可。

### Linux远程登录

可以通过远程登录Linux服务器来管理维护系统。Linux系统中是通过ssh服务实现的远程登录功能，默认ssh服务端口号为22.

windows系统上Linux远程登录客户端SecureCRT,Putty,SSH Secure Shell, 文本以Putty为例来登录远程服务器

**使用密钥认证机制远程登录Linux**

SSH为Secure Shell的缩写，有IETF的网络工作小组(Network Working Group)所制定，SSH为建立在应用层和传输层基础上的安全协议

### Linux文件基本属性

Linux系统是一种典型的多用户系统，不同的用户处于不同的地位，拥有不同的权限，为了保护系统的安全性，Linux系统对不同的用户访问同一文件(包括目录文件)的权限做了不同的规定

在Linux中可以使用ll或ls -l命令来显示一个文件的属性以及文件所属的用户和组

### Linux文件与目录管理

Linux的目录结构为树状结构，最顶级的目录为根目录 / 
其他目录通过挂载可以将它们添加到树中，通过解除挂载可以移除它们。

* 绝对路径：由根目录写起，例如：/usr/share/doc
* 相对路径：由 . 和 .. 等构成，例如：cd ../man

**处理目录的常用命令**

* **ls : 列出目录**

选项与参数：`-a` 全部的文件；`-d`仅列出目录本身，不列出所有文件数据；`-l` 场数据串列出，包含文件的属性与权限等等数据 ，例如 
```bash
ls -al
```

* **cd : 切换目录**

cd是Change Directory的缩写，变换工作目录的命令

```bash
cd [相对路径或绝对路径]
```

* **pwd : 显示目前的目录**

选项与参数： `-P`:显示出确实的路径，而非使用连结(link)路径

* **mkdir : 创建一个新的目录**

选项和参数：`-m`: 配置文件权限，*umask*为默认权限; 
`-p`: 直接将所需要的目录(包含上一级目录)递归创建起来，用于创建多层目录

* **rmdir : 删除一个空的目录**

选项和参数：`-p`: 连同上一级*空的*目录也一起删除

* **cp : 复制文件或目录**

选项和参数：
`-a` : 相当于-pdr的意思
`-d` : 若来源档为连结档的属性(link file)，则复制连结档属性而非文件本身；
`-f` : 为强制(force)的意思，若目标文件已经存在且无法开启，则移除后再尝试一次；
`-i` : 若目标档(destination)已经存在时，在覆盖时会先询问动作的进行(常用)
`-l` : 进行硬式连结(hard link)的连结档创建，而非复制文件本身；
`-p` : 连同文件的属性一起复制过去，而非使用默认属性(备份常用)；
`-r` : 递归持续复制，用於目录的复制行为；(常用)
`-s` : 复制成为符号连结档 (symbolic link)，亦即『捷径』文件；
`-u` : 若 destination 比 source 旧才升级 destination 

* **rm : 移除文件或目录**

选项和参数：
`-f` : force,忽略不存在的文件，不出现警告信息
`-i` : 互动模式，在删除前会询问使用者是否动作
`-r` : 递归删除，

* **mv : 移动文件与目录，或修改文件与目录的名称**

选项和参数：
`-f` : force,如果目标文件已经存在，不会询问而直接覆盖
`-i` : 若目标文件(destination)已经存在时，就会询问是否覆盖
`-u` : 若目标文件已经存在，且source比较新，才会升级(update)

> *可以使用man命令查看各个命令的使用文档*

**Linux文件内容查看**

* **cat : 由第一行开始显示文件内容**

选项与参数
`-A` : 相当於 -vET 的整合选项，可列出一些特殊字符而不是空白而已；
`-b` : 列出行号，仅针对非空白行做行号显示，空白行不标行号！
`-E` : 将结尾的断行字节 $ 显示出来；
`-n` : 列印出行号，连同空白行也会有行号，与 -b 的选项不同；
`-T` : 将 *tab* 按键以 ^I 显示出来；
`-v` : 列出一些看不出来的特殊字符

* **tac : 从最后一行开始显示，tac是cat的倒置写法**

tac与cat命令刚好相反，文件内容从最后一行开始显示，可以看出 tac 是 cat 的倒着写！如：

* **nl : 显示的时候，一同输出行号**

选项与参数
`-b` : 指定行号指定的方式，主要有两种：
`-b a` : 表示不论是否为空行，也同样列出行号(类似 cat -n)；
`-b t` : 如果有空行，空的那一行不要列出行号(默认值)；

`-n` : 列出行号表示的方法，主要有三种：
`-n ln` : 行号在荧幕的最左方显示；
`-n rn` : 行号在自己栏位的最右方显示，且不加 0 ；
`-n rz` : 行号在自己栏位的最右方显示，且加 0 ；

`-w` : 行号栏位的占用的位数。

* **more : 一页一页地显示文件内容**

`空白键(space)` : 代表向下翻一页；
`Enter` : 代表向下翻『一行』；
`/字串` : 代表在这个显示的内容当中，向下搜寻『字串』这个关键字；
`:f` : 立刻显示出档名以及目前显示的行数；
`q` : 代表立刻离开 more ，不再显示该文件内容。
`b或[ctrl]-b` : 代表往回翻页，不过这动作只对文件有用，对管线无用。

* **less : less与more类似，但是向前翻页**

`空白键(space)` : 向下翻动一页；
`[pagedown]` : 向下翻动一页；
`[pageup]` : 向上翻动一页；
`/字串` : 向下搜寻『字串』的功能；
`?字串` : 向上搜寻『字串』的功能；
`n` : 重复前一个搜寻 (与 / 或 ? 有关！)
`N` : 反向的重复前一个搜寻 (与 / 或 ? 有关！)
`q` : 离开 less 这个程序；

* **head : 只看头几行**

`-n` : 后面接数字，代表显示几行的意思

* **tail : 只看尾几行**

`-n` : 后面接数字，代表显示几行的意思
`-f` : 表示持续侦测后面所接的档名，要等到按下[ctrl]-c才会结束tail的侦测

### Linux用户和用户组管理

Linux系统是一个多用户多任务的分时操作系统，任何一个要使用系统资源的用户，都必须首先向系统管理员申请一个账号，然后以这个账号的身份进入系统

每个用户账号都拥有唯一的用户名和各自的口令，用户在登录时键入正确的用户名和口令后，就能够进入系统和自己的主目录

* 用户账号的添加、删除与修改
* 用户口令的管理
* 用户组的管理

**一、Linux系统用户账号的管理**

涉及用户账号的添加、修改和删除.添加用户账号就是在系统中创建一个新账号，然后为新账号分配用户号、用户组、主目录和登录Shell等资源。刚添加的账号是被锁定的，无法使用

**1.添加新的用户账号使用useradd命令，其语法如下：**

```bash
useradd 选项 用户名
```
参数和选项：
`-c comment` : 指定一段注释性描述；
`-d` : 目录 指定用户主目录，如果此目录不存在，则同时使用-m选项，可以创建主目录。
`-g` : 用户组 指定用户所属的用户组。
`-G` : 用户组，用户组 指定用户所属的附加组。
`-s` : Shell文件 指定用户的登录Shell。
`-u` : 用户号 指定用户的用户号，如果同时有-o选项，则可以重复使用其他用户的标识号。

```bash
useradd -d /usr/sam -m sam
```

此命令创建了一个用户sam，其中-d和-m选项用来为登录名sam产生一个主目录/usr/sam (/usr为默认的用户主目录所在的父目录)

```bash
useradd -s /bin/sh -g group -G adm, root gem
```

此命令创建了一个用户gem,该用户的登录Shell是/bin/sh,又同时数据adm和root用户组，其中group用户组是其主组。
这里可能新建组：#groupadd group及group adm
增加用户账号就是在/etc/passwd文件中为新用户增加一条记录，同时更新其他系统文件如/etc/shadow,/etc/group等。

*Linux提供了集成的系统管理工具userconf,可以用来对用户账号进行统一管理*

**2.删除账号**

删除用户账号就是要将/etc/passwd等系统文件中的该用户记录删除，必要时还删除用户的主目录

```bash
user del 选项 用户名
```

常用选项是`-r`,作用是把用户的主目录一起删除

**3.修改账号**

根据实际情况更改用户的有关属性，如用户号，主目录，用户组，登录Shell等。。

```bash
usermod 选项 用户名
```

参数和选项：
`-c comment` : 指定一段注释性描述；
`-d` : 目录 指定用户主目录，如果此目录不存在，则同时使用-m选项，可以创建主目录。
`-g` : 用户组 指定用户所属的用户组。
`-G` : 用户组，用户组 指定用户所属的附加组。
`-s` : Shell文件 指定用户的登录Shell。
`-u` : 用户号 指定用户的用户号，如果同时有-o选项，则可以重复使用其他用户的标识号。
`-l` : 新用户名

**4.用户口令的管理**

用户创建时没有口令，但是被系统锁定，无法使用，必须为其制定口令后才可以使用，即使是空口令。

```bash
passwd 选项 用户名
```

参数和选项：
`-l` : 锁定口令，即禁用账号
`-u` : 口令解锁
`-d` : 使账号无口令。
`-f` : 强迫用户下次登录时修改口令。

如果是超级用户，可以使用下列形式指定任何用户的口令
```bash
passwd sam
```

**二、Linux系统用户组的管理**

用户组的管理涉及用户组的添加、删除和修改。组的增加、删除和修改实际上就是对/etc/group文件的更新

**1.增加一个新的用户组**

```bash
groupadd 选项 用户组
```

参数和选项：
`-g` : GID指定新用户组的组标识号(GID)
`-o` : 一般与-g选项同时使用，表示新用户组的GID可以与系统已有用户组的GID相同

**2.删除一个已有用户组**

```bash
groupdel 用户组
```

**3.修改用户组的属性使用groupmod命令。其语法如下**

groupmod 选项 用户组

参数和选项：
`-g` : GID指定新用户组的组标识号(GID)
`-o` : 一般与-g选项同时使用，表示新用户组的GID可以与系统已有用户组的GID相同
`-n` : 新用户组 将用户组的名字改为新名字

**4.如果一个用户同时属于多个用户组，那么可以在用户组之间切换，以便具有其他用户组的权限**

使用newgrp命令切换到其他用户组

**三、与用户账号有关的系统文件**

这些文件包括/etc/passwd, /etc/shadow, /etc/group

**1./etc/passwd文件是用户管理工作涉及的最重要的一个文件**

对所有用户可读，一行记录对应着一个用户，每行记录又被冒号(:)分隔为7个字段，其格式含义如下：

```bash
用户名:口令:用户标识号:组标识号:注释性描述:主目录:登录Shell
```

* "用户名"是代表用户账号的字符串。
* “口令”一些系统中，存放着加密后的用户口令字。
* “用户标识号”是一个整数，系统内部用它来标识用户。
* “组标识号”字段记录的是用户所属的用户组。
* “注释性描述”字段记录着用户的一些个人情况。
* “主目录”，也就是用户的起始工作目录。
* 用户登录后，要启动一个进程，负责将用户的操作传给内核，这个进程是用户登录到系统后运行的命令解释器或某个特定的程序，即Shell。
* 系统中有一类用户称为伪用户（pseudo users）。

**2.拥有账户文件**

1.除了上面列出的伪用户外，还有许多标准的伪用户，例如：**audit，cron，mail，usenet**等，它们也都各自为相关的进程和文件所需要

2./etc/shadow中的记录行与/etc/passwd中的一一对应，由pwconv命令根据/etc/passwd中的数据自动产生

```bash
登录名:加密口令:最后一次修改时间:最小时间间隔:最大时间间隔:警告时间:不活动时间:失效时间:标志
```

**3.用户组的所有信息都存放在/etc/group文件中**

将用户分组是Linux系统中对用户进行管理及控制访问权限的一种手段
每个用户都属于某个用户组：一个组中可以有多个用户，一个用户也可以属于不同的组
用户要访问属于附加组的文件时，必须首先使用newgrp命令使自己成为所要访问的组中的成员.
用户组的所有信息都存放在/etc/group文件中。此文件的格式也类似于/etc/passwd文件,由冒号(:)隔开若干个字段，这些字段有：

```bash
组名:口令:组标识号:组内用户列表
```

* "组名"是用户组的名称，由字母或数字构成。与/etc/passwd中的登录名一样，组名不应重复。
* "口令"字段存放的是用户组加密后的口令字。一般Linux 系统的用户组都没有口令，即这个字段一般为空，或者是*。
* "组标识号"与用户标识号类似，也是一个整数，被系统内部用来标识组。
* "组内用户列表"是属于这个组的所有用户的列表/b]，不同用户之间用逗号(,)分隔。这个用户组可能是用户的主组，也可能是附加组。

**四、批量添加用户**

* 1.先编辑一个文本用户文件:每一列按照/etc/passwd密码文件的格式书写，要注意每个用户的用户名、UID/宿主目录都不可以相同，其中密码栏可以留作空白或输入x号。
* 2.以root身份执行命令、/usr/sbin/newusers,从刚创建的用户文件user.txt中导入数据
* 3.执行命令/usr/sbin/pwunconv。
* 4.编辑每个用户的密码对照文件。
* 5.以root身份执行命令 /usr/sbin/chpasswd
* 6.确定密码经编码写入/etc/passwd的密码栏后。

### Linux磁盘管理

Linux磁盘管理好坏直接关系到整个系统的性能问题
Linux磁盘管理常用三个命令为df、du和fidisk

* **df** : 列出文件系统的整体磁盘使用量

df命令参数功能：检查文件系统的磁盘空间占用情况。可以利用该命令来获取
硬盘被占用了多少空间，目前还剩下多少空间信息

选项和参数：
* -a : 列出所有的文件系统，包括系统特有的/proc等文件系统
* -k : 以 KBytes 的容量显示各文件系统；
* -m : 以 MBytes 的容量显示各文件系统；
* -h : 以人们较易阅读的 GBytes, MBytes, KBytes 等格式自行显示；
* -H : 以 M=1000K 取代 M=1024K 的进位方式；
* -T : 显示文件系统类型, 连同该 partition 的 filesystem 名称 (例如 ext3) 也列出；
* -i : 不用硬盘容量，而以 inode 的数量来显示

注意：*在Linux操作系统下，如果df没有加任何选项,那么默认会将系统内所有的(不含特殊内存的文件系统与swap)都以1Kbytes的容量来列出来*

* **du** : 检查磁盘空间使用量

Linux du命令也是查看使用空间的，但是与df命令不同的是Linux du命令是对文件和目录磁盘使用的查看，还是和df命令有一些区别的

选项和参数：
* -a : 列出所有的文件与目录容量，因为默认仅统计目录底下的文件量而已。
* -h : 以人们较易读的容量格式 (G/M) 显示；
* -s : 列出总量而已，而不列出每个各别的目录占用容量；
* -S : 不包括子目录下的总计，与 -s 有点差别。
* -k : 以 KBytes 列出容量显示；
* -m : 以 MBytes 列出容量显示；

通配符*来代表每个目录
与df不一样的是，du这个命令其实会直接到文件系统内去搜寻所有的文件数据

* **fdisk** : 用于磁盘分区

选项和参数：
* -l : 输出后面接的装置所有的分区内容。若仅有 fdisk -l 时， 则系统将会把整个系统内能够搜寻到的装置的分区均列出来。

**磁盘格式化**
磁盘分割完毕后自然是对文件系统的格式化，格式化的命令非常的简单

```bash
mkfs [-t 文件系统格式] 装置文件名
```

选项和参数：
* -t : 可以接文件系统格式，例如 ext3, ext2, vfat 等(系统有支持才会生效)

**磁盘检验**
fsck(file system check)用来检查和维护一致的文件系统。若系统掉电或者磁盘发生问题，可利用fsck命令对文件系统进行检查
```bash
fsck [-t 文件系统] [-ACay] 装置名称
```

选项和参数：
* -t : 给定档案系统的型式，若在 /etc/fstab 中已有定义或 kernel 本身已支援的则不需加上此参数
* -s : 依序一个一个地执行 fsck 的指令来检查
* -A : 对/etc/fstab 中所有列出来的 分区（partition）做检查
* -C : 显示完整的检查进度
* -d : 打印出 e2fsck 的 debug 结果
* -p : 同时有 -A 条件时，同时有多个 fsck 的检查一起执行
* -R : 同时有 -A 条件时，省略 / 不检查
* -V : 详细显示模式
* -a : 如果检查有错则自动修复
* -r : 如果检查有错则由使用者回答是否修复
* -y : 选项指定检测每个文件是自动输入yes，在不确定那些是不正常的时候，可以执行 # fsck -y 全部检查修复。

**磁盘挂载与卸除**
Linux的磁盘挂载使用mount命令，卸载使用umount命令

磁盘挂载语法:
```bash
mount [-t 文件系统] [-L Label名] [-o 额外选项] [-n]  装置文件名  挂载点
```
磁盘卸载命令umount语法:
```bash
umount [-fn] 装置文件名或挂载点
```

选项与参数
* -f : 强制卸除！可用在类似网络文件系统 (NFS) 无法读取到的情况下；
* -n : 不升级 /etc/mtab 情况下卸除。

Linux 操作系统的文件数据除了文件实际内容外，通常含有非常多的属性，例如 Linux 操作系统的文件权限（rwx）与文件属性（拥有者、群组、时间参数等）。文件系统通常会将这两部分的数据分别存放在不同的区块，权限与属性存放在 inode 中，至于实际数据则放置到 data block 区块中。另外，还有一个超级区块（superblock）会记录整个文件系统的整体信息，包括 inode 与 block 的总量、使用量、剩余量等。

inode：记录文件的属性，一个文件占用一个 inode，同时记录此文件的数据所在的 block。

在 Linux 中，可以使用 stat 命令查看某个文件的 inode 信息：

### Linux vi/vim

所有的Unix Like系统都会内建vi文书编辑器，其他的不一定存在。目前使用较多是vim编辑器

Vim是从vi发展出来的一个文本编辑器，类似于Sublime，VS Code等

**三种使用模式**:
* 命令模式：

几种常用的几个命令
* i切换到输入模式，以输入字符
* **x**删除当前光标所在处的字符
* :切换到底线命令模式，以在最底一行输入命令

* 输入模式：

输入模式中可以使用的按键
* 字符按键以及Shift组合：输入字符
* ENTER:回车键，换行
* BACK SPACE:退格键，删除光标前一个字符
* DEL:删除键，删除光标后一个字符
* 方向键：在文本中移动光标
* HOME/END:移动光标到行首/行尾
* Page Up/Page Down:上/下翻页
* Insert:切换光标为输入/替换模式，光标将变成竖线/下划线
* ESC:退出输入模式，切换到命令模式

* 底线命令模式：

在命令模式下按下英文冒号就进入了底线命令模式
* q 退出程序
* w 保存文件

### Linux yum命令

yum (Yellow dog Updater, Modified)是一个在Fedora和RedHat以及SUSE中的Shell前端软件包管理器。基于RPM包管理，能够从指定的服务器自动下载RPM包并且安装，可以自动处理依赖关系，并且一次安装所有依赖的软件包，无须繁琐地一次次下载、安装

yum提供了查找、安装、删除某一个、一组甚至全部软件包的命令，简洁好记

语法：
```bash
yum [options] [command] [package ...]
```

* options：可选，选项包括-h（帮助），-y（当安装过程提示选择全部为“yes”）,-q（不显示安装的过程）等等。
* command：要进行的操作
* package：操作的对象

常用命令:
* **yum check-update** ：列出所有可更新的软件清单命令
* **yum update** ：更新所有软件命令
* **yum install \<package_name\>** ：仅安装指定的软件命令
* **yum update \<package_name\>** ：仅更新指定的软件命令
* **yum list** ：列出所有可安裝的软件清单命令
* **yum remove \<package_name\>** ：删除软件包命令
* **yum search \<keyword\>** ：查找软件包命令
* **yum clean packages** ：清除缓存目录下的软件包
* **yum clean headers** ：清除缓存目录下的 headers
* **yum clean oldheaders** ：清除缓存目录下旧的 headers
* **yum clean, yum clean all** ：清除缓存目录下的软件包及旧的headers

**国内yum源**

网易(163)yum源是国内最好的yum源之一，无论是速度还是软件版本，都非常不错
将yum源设置为163 yum，可以提升软件包安装和更新速度，同时避免一些常见软件版本无法找到

安装步骤
* 1.首先备份/etc/yum.repos.d/CentOS-Base.repo
```bash
mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup
```
* 2.下载对应操作系统版本的repo文件，放入/etc/yum.repos.d/ (操作前做好相应备份)
```bash
wget http://mirrors.163.com/.help/CentOS6-Base-163.repo
mv CentOS6-Base-163.repo CentOS-Base.repo
```
* 3.运行以下命令生成缓存
```bash
yum clean all
yum makecache
```

### Linux命令大全

[菜鸟教程链接](http://www.runoob.com/linux/linux-command-manual.html)

## 操作系统问答

1. Linux虚拟地址空间

在多任务操作系统中，每个进程都运行在属于自己的内存沙盘中。这个沙盘就是虚拟地址空间(Virtual Address Space)，在32位模式下它是一个4GB的内存地址块。在Linux系统中, 内核进程和用户进程所占的虚拟内存比例是1:3，而Windows系统为2:2(通过设置Large-Address-Aware Executables标志也可为1:3)。这并不意味着内核使用那么多物理内存，仅表示它可支配这部分地址空间，根据需要将其映射到物理内存。

2. 操作系统中的程序的内存结构

3. 操作系统中的缺页中断

4. fork和vfork的区别

5. 如何修改文件最大句柄数？

6. 并发(concurrency)和并行(parallelism)

7. 操作系统中的页表寻址

8. 单核机器上写多线程程序，是否需要考虑加锁，为什么？

9. 线程需要保存哪些上下文，SP、PC、EAX这些寄存器是干嘛用的

10. 线程间的同步方式，最好说出具体的系统调用

11. 多线程和多进程的不同

12. 游戏服务器应该为每个用户开辟一个线程还是一个进程，为什么？

13. OS缺页置换算法

14. 多进程和多线程的使用场景

15. 死锁发生的条件以及如何解决死锁

16. 虚拟内存和物理内存怎么对应

17. 操作系统中的结构体对齐，字节对齐

18. 进程间怎么通信

19. 虚拟内存置换的方式

20. 多线程，线程同步的几种方式

21. 互斥锁（mutex）机制，以及互斥锁和读写锁的区别

22. 进程状态转换图，动态就绪，静态就绪，动态阻塞，静态阻塞

23. A a = new A; a->i = 10;在内核中的内存分配上发生了什么？

24. 一个类，里面有static，virtual，之类的，来说一说这个类的内存分布

25. 软链接和硬链接区别

26. 什么是大端小端以及如何判断大端小端

27. 静态变量什么时候初始化

28. 用户态和内核态区别

29. 如何设计server，使得能够接收多个客户端的请求

30. 死循环+来连接时新建线程的方法效率有点低，怎么改进？

31. 唤醒被阻塞的socket线程？

32. 怎样确定当前线程是繁忙还是阻塞？

33. 空闲的进程和阻塞的进程状态会不会在唤醒的时候误判？

34. 

35. 

36. 

37. 

38. 

39. 

40. 
